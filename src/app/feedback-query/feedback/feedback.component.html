<!-- Button trigger modal
<button type="button" (click)="modalOpen(modalBasic)" class="btn btn-primary" rippleEffect>
  Add New Query
</button> -->

<!-- Modal -->
<ng-template #modalBasic let-modal>
  <div class="modal-header">
    <h4 class="modal-title" id="myModalLabel1">Update Feedback</h4>
    <button type="button" class="close" (click)="modal.dismiss('Cross click')" aria-label="Close">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body" tabindex="0" ngbAutofocus>
 
              <form [formGroup]="feedbackUpdateForm" (ngSubmit)="onSubmit(feedbackUpdateForm.value)"novalidate>
                  <div class="form-group p-2">
                    <select class="form-control" formControlName="status">
                      <option value="1">open</option>
                      <option value="2">in_process</option>
                      <option value="3">closed</option>
                      <option value="4">confirmed</option>
                    </select>
                      <!-- <label for="title">Status</label>
                      <input type="text" name="status" placeholder="Status" class="form-control" formControlName="status"> -->
                      <!-- <ng-container *ngIf="isFormValid || (!f?.status?.valid && (f?.status?.dirty || f?.status?.touched))">
                          <small class="form-text" [hidden]="!f?.status?.errors?.['required']">status is required *</small>
                      </ng-container> -->
                  </div>
                  <div class="form-group p-2">
                      <label for="description">feedback_remark</label>
                          <textarea placeholder="feedback_remark" class="form-control" formControlName="feedback_remark"></textarea>
                          <ng-container *ngIf=" !f?.feedback_remark?.valid && (f?.feedback_remark?.dirty || f?.feedback_remark?.touched)">
                              <small class="form-text" [hidden]="!f?.feedback_remark?.errors?.['required']">feedback_remark is required *</small>
                          </ng-container>
                  </div>
                  <div class="form-group p-2">
                      <button  type="submit" class="btn btn-primary px-4" >Update</button>
                      <button type="button" (click)="modal.dismiss('cancel')"  class="btn btn-danger px-4 mx-4">Cancel</button>
                  </div>
              </form>
          </div>
  
  <!-- <div class="modal-footer">
    <button type="button" class="btn btn-primary" (click)="modal.close('Accept click')" rippleEffect>
      Accept
    </button>
  </div> -->
</ng-template>
<!-- / Modal -->




<div class="content-wrapper container-xxl p-0">
    <div class="content-body">
      <!-- User List -->
      <section class="users-list-wrapper">
        <!-- users filter start -->
        <div class="card">
          <!-- <h5 class="card-header">Search Filter</h5> -->
          <div class="card-body">
            <div class="users-list-filter">
              <form>
                <div class="row justify-content-between">
                  <!-- <div class="col-12 col-md-4">
                    <fieldset class="form-group">
                      <ng-select
                        [items]="selectRole"
                        [(ngModel)]="selectedRole"
                        name="selectedRole"
                        bindLabel="name"
                        placeholder="Select Role"
                        (change)="filterByRole($event)"
                      ></ng-select>
                    </fieldset>
                  </div>
   -->
            
  
                  <!-- <div class="col-12 ml-5 col-md-4">
                    <fieldset class="form-group">
                      <ng-select
                        [items]="selectDepartment"
                        [(ngModel)]="selectedDepartment"
                        name="selectedDepartment"
                        bindLabel="name"
                        placeholder="Select Department"
                        (change)="filterByDepartment($event)"
                      ></ng-select>
                    </fieldset>
                  </div> -->
        <div class="col-12 col-md-4">
          <app-query #querycomponent></app-query>

        </div>
                </div>
              </form>
            </div>
          </div>
        </div>
        <!-- users filter end -->
  
        <div class="card">
          <div class="row">
            <div class="col-md-6 col-12">
              <div class="d-flex justify-content-between align-items-center m-1">
                <label class="d-flex align-items-center"
                  >Show
                  <select class="form-control mx-25" (change)="Totaldata()">
                    <option value="10">10</option>
                    <option value="25">25</option>
                    <option value="50">50</option>
                    <option value="100">100</option>
                  </select>
                  entries</label
                >
              </div>
            </div>
            <div class="col-md-6 col-12 d-flex justify-content-start justify-content-md-end">
              <div class="d-flex align-items-center justify-content-end pr-1 pb-1 pb-md-0">
                <label class="d-flex align-items-center ml-1 ml-md-0"
                  >Search:<input
                    [(ngModel)]="searchValue"
                    name="searchValue"
                    type="search"
                    class="form-control ml-25"
                    #myInput
                /></label>
                <!-- <button class="btn btn-primary ml-1" rippleEffect (click)="toggleSidebar('query')">
                  <i data-feather="plus" class="d-sm-none d-inline-block mr-0 mr-sm-1"></i
                  ><span class="d-none d-sm-inline-block">Add New Query</span>
                </button> -->
              </div>
            </div>
          </div>
          <ngx-datatable
            [rows]="rows"
            [rowHeight]="50"
            class="bootstrap core-bootstrap"
            [limit]="selectedOption"
            [columnMode]="ColumnMode.force"
            [headerHeight]="50"
            [footerHeight]="50"
            [scrollbarH]="true"
            [count]="rowsCount"
            [externalPaging]="true"
            (page)="page($event)"
            #tableRowDetails
            
          >

          <!-- for description -->
        <ngx-datatable-row-detail [rowHeight]="50" >
          <ng-template let-row="row" let-expanded="expanded" ngx-datatable-row-detail-template>
            <div class="ml-75 pl-5 pt-75">
              <div>
                <strong>DESCRIPTION:</strong>
                {{row.feedback_description}}
              </div>
            </div>
          </ng-template>
        </ngx-datatable-row-detail>
        <ngx-datatable-column [width]="50" [resizeable]="false" [sortable]="false" [draggable]="false"
          [canAutoResize]="false">
          <ng-template let-row="row" let-expanded="expanded" ngx-datatable-cell-template>
            <a href="javascript:void(0)" [class.datatable-icon-right]="!expanded" [class.datatable-icon-down]="expanded"
              title="Expand/Collapse Row" (click)="rowDetailsToggleExpand(row)">
            </a>
          </ng-template>
        </ngx-datatable-column>
        
            <ngx-datatable-column name="Feedback title" prop="feedback_title" [width]="200"></ngx-datatable-column>
      
            <!-- <ngx-datatable-column name="description" prop="feedback_description" [width]="200"></ngx-datatable-column> -->

  
             
            <ngx-datatable-column name="Assigned_To" prop="assigned_to.first_name" [width]="200"></ngx-datatable-column>
            
            <ngx-datatable-column name="requested_by" prop="requested_by.first_name" [width]="200"></ngx-datatable-column>
  
           
            <ngx-datatable-column name="feedback_status" prop="status" [width]="100">
              <ng-template let-status="value" ngx-datatable-cell-template>
                <div>
                  <i
                    class="feather font-medium-3"
                    [ngClass]="{
              
                      'icon-slack text-primary': status == 'OPEN',
                      'icon-slack text-danger': status == 'IN_PROCESS',
                      'icon-slack text-danger': status == 'CLOSED',
                      'icon-slack text-danger': status == 'CONFIRMED'
                    }"
                  ></i>
                  <!-- {{ role == 1?"ADMIN":role == 2?"DELIVERY_MANAGER":role == 3?"ACCOUNTS":role ==4?"HR" 
                  :role ==5?"PM":role ==6?"TL":role ==7?"USER":"others"}} -->
                  {{status}}
                </div>
              </ng-template>
            </ngx-datatable-column>

        
            <ngx-datatable-column name="Actions" [width]="40" [sortable]="false">
              <ng-template ngx-datatable-cell-template let-row="row">
                <div ngbDropdown container="body">
                  <button ngbDropdownToggle type="button" class="btn icon-btn btn-sm hide-arrow" rippleEffect>
                    <span [data-feather]="'more-vertical'" [class]="'cursor-pointer'"></span>
                  </button>
                  <div ngbDropdownMenu>
                    <a routerLink="/apps/user/user-view/{{ row.id }}" ngbDropdownItem
                      ><span [data-feather]="'file-text'" [size]="16" [class]="'mr-50'"></span> Details</a
                    ><a  (click)="modalOpen(modalBasic,row.status,row._id)" rippleEffect ngbDropdownItem
                      ><span [data-feather]="'edit'" [size]="16" [class]="'mr-50'"></span> Edit</a
                    ><a (click)="deleteData(row._id)" ngbDropdownItem
                      ><span [data-feather]="'trash'" [size]="16" [class]="'mr-50'"></span> Delete</a
                    >
                    <a (click)="userDetail()" ngbDropdownItem
                      ><span [data-feather]="'trash'" [size]="16" [class]="'mr-50'"></span> userDetails</a
                    >
                  </div>
                </div>
              </ng-template>
            </ngx-datatable-column>
          </ngx-datatable>
        </div>
      </section>
      <!--/ User List -->
    </div>
  
    <!-- New User Sidebar -->
    <core-sidebar
      class="modal modal-slide-in sidebar-todo-modal fade"
      name="query"
      overlayClass="modal-backdrop"
    >
      <!-- <app-query></app-query> -->
    </core-sidebar>
    <!--/ New User Sidebar -->
  </div>
  